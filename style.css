/* --- [v4.0] 피드백 반영: '토스' 스타일 적용 --- */
:root {
    --primary-color: #4A80F3;
    --text-color: #333333; /* [v4.0] 더 부드러운 검정색 */
    --light-bg-color: #f9f9f9; /* [v4.0] 기본 배경색으로 사용 */
    --border-color: #e0e0e0;
    --success-color: #28a745;
    --warning-color: #fd7e14;
    --danger-color: #dc3545;
    --white-color: #FFFFFF;
    --font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", "Segoe UI", "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
}

body {
    font-family: var(--font-family);
    /* [v4.0] 피드백 반영: 배경색을 밝은 회색으로 변경 */
    background-color: var(--light-bg-color);
    color: var(--text-color);
    line-height: 1.7;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    font-size: 16px;
}

.container {
    width: 100%;
    /* [v4.0] 피드백 반영: '토스' 스타일 (좁은 폭) */
    max-width: 720px;
    /* [v4.0] 피드백 반영: 여백 증가 */
    padding: 64px 24px;
    box-sizing: border-box;
}

header {
    text-align: center;
    margin-bottom: 48px;
}

header h1 {
    /* [v4.0] 피드백 반영: 타이포그래피 (더 대담하게) */
    font-size: 42px;
    font-weight: 900; /* [v4.0] */
    margin: 0;
    color: var(--primary-color);
}

header p {
    /* [v4.0] 피드백 반영: 타이포그래피 (본문) */
    font-size: 18px;
    color: #666; /* [v4.0] */
    margin-top: 12px;
}

#error-banner {
    background-color: var(--danger-color);
    color: var(--white-color);
    padding: 16px 24px;
    border-radius: 12px; /* [v4.0] */
    margin-bottom: 32px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
}
#error-message { font-weight: 600; margin: 0; }
#error-close {
    background: none; border: none; color: var(--white-color);
    font-size: 24px; font-weight: 700; cursor: pointer;
    padding: 0 8px; line-height: 1; opacity: 0.8; transition: opacity 0.2s;
}
#error-close:hover { opacity: 1; }

.main-card {
    background-color: var(--white-color);
    /* [v4.0] 피드백 반영: '토스' 스타일 (테두리 제거) */
    border: none;
    /* [v4.0] 피드백 반영: '토스' 스타일 (더 둥글게) */
    border-radius: 20px;
    padding: 40px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.08); /* [v4.0] */
    /* [v4.1] 카드 간 여백 확보 */
    margin-bottom: 40px; 
    /* [v4.0] 피드백 반영: '뒤로 가기' 버튼 위치 기준 */
    position: relative; 
}

/* --- [v4.0] 피드백 반영: 단계별 UI 스타일 --- */
#input-section h2, 
#course-section h2, 
#analysis-section h2, 
#feedback-report-section h2 {
    /* [v4.0] h2 공통 스타일: 마진, 폰트 크기, 굵기 */
    margin-top: 0;
    margin-bottom: 24px;
    font-size: 28px;
    font-weight: 800;
    /* [v4.0] 피드백 반영: h2 기본 밑줄 제거 */
    border-bottom: none;
    padding-bottom: 0;
}

/* [v4.0] 피드백 반영: 단계별 제목 (토스 스타일) */
.step-title {
    font-size: 36px; /* [v4.0] */
    font-weight: 900; /* [v4.0] */
    line-height: 1.4; /* [v4.0] */
    margin-bottom: 32px; /* [v4.0] */
    text-align: left; /* [v4.0] */
}

/* [v4.0] 피드백 반영: 뒤로 가기 버튼 */
.btn-back {
    position: absolute;
    top: 32px; /* [v4.0] */
    left: 32px; /* [v4.0] */
    background: var(--light-bg-color);
    color: var(--text-color);
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 20px;
    font-weight: 700;
    cursor: pointer;
    transition: background-color 0.2s ease;
    padding: 0;
    line-height: 40px;
    text-align: center;
}
.btn-back:hover {
    background-color: var(--border-color);
}

/* [v4.0] 코스 선택 섹션의 제목은 뒤로가기 버튼 고려해 패딩 추가 */
#course-section .step-title {
    padding-top: 24px;
}
/* --- [END v4.0] 단계별 UI 스타일 --- */


#text-input {
    width: 100%; height: 180px; padding: 16px;
    border: 1px solid var(--border-color); border-radius: 12px; /* [v4.0] */
    font-family: var(--font-family); font-size: 16px;
    resize: vertical; box-sizing: border-box; margin-bottom: 8px;
}

#char-counter {
    text-align: right; font-size: 14px;
    font-weight: 500; color: var(--danger-color);
}
#char-counter.sufficient {
    color: var(--success-color); font-weight: 600;
}

.course-options { margin-top: 24px; display: flex; gap: 16px; }
.course-option {
    flex: 1; padding: 20px; border: 2px solid var(--border-color); /* [v4.0] */
    border-radius: 12px; /* [v4.0] */
    cursor: pointer; transition: all 0.2s ease;
    text-align: center;
}
.course-option:hover {
    border-color: #ccc; /* [v4.0] */
    background-color: var(--light-bg-color); /* [v4.0] */
}
.course-option.selected {
    border-color: var(--primary-color);
    background-color: #f7f9ff; /* [v4.0] */
    box-shadow: 0 0 0 3px rgba(74, 128, 243, 0.2);
}
.course-option h3 { margin: 0 0 8px 0; font-size: 17px; font-weight: 700; }
.course-option p { margin: 0; font-size: 15px; color: #555; }

.btn {
    display: block; width: 100%; padding: 18px;
    margin-top: 32px;
    background-color: var(--primary-color);
    color: var(--white-color); border: none; border-radius: 12px; /* [v4.0] */
    font-size: 18px; font-weight: 700; cursor: pointer;
    transition: background-color 0.2s ease; box-sizing: border-box;
}

/* [v4.0] 2순위 버튼 (PDF 저장, 새로 시작) */
.btn-secondary {
    background-color: #6c757d;
    margin-top: 32px;
}
.btn-secondary:hover { background-color: #5a6268; }

/* --- [v4.1] 리포트 섹션 버튼 (CTA 카드 내부) --- */
/*
   [v4.1] 기존 auto 너비/중앙 정렬 스타일(line 217-231)을 삭제하고
   CTA 카드 내부에서 100% 너비를 갖도록 재정의합니다.
*/
#generate-prompt-button {
    /* 이 버튼은 기본 .btn (파란색) 스타일을 사용합니다. */
    /* [v4.1] CTA 카드 내부의 첫 버튼이므로 상단 마진 재정의 */
    margin-top: 0;
}

#download-pdf-button, 
#reset-button {
    /* 이 버튼들은 .btn-secondary (회색) 스타일을 사용합니다. */
    /* [v4.1] 두 번째, 세 번째 버튼이므로 상단 마진 16px */
    margin-top: 16px;
}
/* --- [END v4.1] 리포트 섹션 버튼 --- */


.btn:hover { background-color: #3a6cc7; }
.btn:disabled { background-color: #a0b9e8; cursor: not-allowed; }

/* --- [v2.0] 훈련 섹션 (포커스 모드) --- */
#analysis-section h2 {
    text-align: center;
    margin-bottom: 12px;
}
#progress-indicator {
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    color: var(--primary-color);
    margin-bottom: 24px;
}

/* 훈련 카드 (단일) */
.chunk-card {
    background: var(--white-color);
    border: 1px solid var(--border-color);
    border-radius: 16px; /* [v4.0] */
    margin-bottom: 24px;
    padding: 32px;
    display: grid;
    grid-template-columns: 1fr 1.5fr;
    gap: 32px;
}
.original-text-container {
    background-color: var(--light-bg-color);
    padding: 20px; border-radius: 12px; border: 1px solid #eee; /* [v4.0] */
}
.original-text-container h4 {
    margin: 0 0 12px 0; font-size: 15px; font-weight: 700;
    color: #555; display: flex; align-items: center; gap: 6px;
}
p.original-text {
    font-size: 16px; line-height: 1.7; margin: 0;
    word-break: keep-all;
}
.analysis-input-container h4 {
    margin: 0 0 12px 0; font-size: 15px; font-weight: 700;
    color: var(--primary-color); display: flex; align-items: center; gap: 6px;
}
textarea.analysis-input {
    width: 100%; height: 160px; padding: 14px;
    border: 1px solid var(--border-color); border-radius: 12px; /* [v4.0] */
    font-family: var(--font-family); font-size: 16px;
    resize: vertical; box-sizing: border-box;
    transition: border-color 0.2s, box-shadow 0.2s;
}
textarea.analysis-input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(74, 128, 243, 0.2);
    outline: none;
}
textarea.analysis-input.invalid {
    border: 1px solid var(--danger-color);
    box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
}
/* --- [END v2.0] 훈련 섹션 --- */


/* --- [v2.1] 피드백 리포트 섹션 --- */
#feedback-report-section {
    width: 100%; max-width: 720px; /* [v4.0] */
    padding: 0; box-sizing: border-box;
    animation: fadeIn 0.5s ease-out;
    /* [v4.1] 리포트 섹션 자체의 하단 마진은 제거 (내부 카드들이 마진을 가짐) */
}

.report-header {
    text-align: center;
    padding: 48px 32px;
    border-radius: 20px; /* [v4.0] */
    /* [v4.1] html 구조 변경으로 인해, 점수 카드(헤더)가 요약까지 포함하므로
       기존 main-card의 기본 하단 마진(40px)을 사용함.
    */
}
.report-header h2 {
    font-size: 24px;
    margin: 0 0 24px 0;
    color: #555;
    font-weight: 700;
}
#feedback-score-container { text-align: center; }

#feedback-score-label {
    font-size: 16px;
    font-weight: 600;
    color: #555;
    margin: 0 0 8px 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}
#feedback-score {
    font-size: 104px;
    font-weight: 900;
    margin: 0;
    line-height: 1;
}
.score-s { color: var(--success-color); } /* 85+ */
.score-a { color: var(--primary-color); } /* 60-84 */
.score-b { color: var(--warning-color); } /* 40-59 */
.score-c { color: var(--danger-color); }  /* 0-39 */

#feedback-summary {
    font-size: 20px;
    font-weight: 600;
    margin-top: 16px;
    margin-bottom: 32px;
    color: #444;
    max-width: 450px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.6;
}

/* [v4.1] 핵심 요약 카드 내부에 추가된 '훈련 결과 (요약)' h2 */
.report-summary-title {
    text-align: center;
    font-size: 22px; /* h2(28px)보다 약간 작게 */
    font-weight: 700;
    margin-top: 48px; /* 점수와 요약 섹션 구분 */
    margin-bottom: 32px;
    border: none;
    padding: 0;
}


#chart-container { display: none; }

/* --- [수정] 아코디언 UI 적용 --- */
#detailed-review-container {
    display: flex;
    flex-direction: column;
    gap: 16px; /* 카드 간격을 16px로 줄임 */
}

/* [수정] .review-card를 details 태그 기준으로 변경 */
.review-card {
    background-color: var(--white-color);
    border: 1px solid var(--border-color);
    border-radius: 16px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    overflow: hidden;
    transition: background-color 0.2s ease;
}

/* [수정] 헤더를 summary 태그 기준으로 변경 */
.review-card-header {
    background-color: var(--light-bg-color);
    padding: 16px 24px;
    border-bottom: 1px solid var(--border-color);
    cursor: pointer; /* 클릭 가능하도록 커서 변경 */
    transition: background-color 0.2s ease;
    list-style: none; /* summary의 기본 화살표 제거 (IE/Edge) */
}
.review-card-header::-webkit-details-marker {
    display: none; /* summary의 기본 화살표 제거 (Chrome/Safari) */
}
.review-card-header:hover {
    background-color: #f0f0f0;
}

.review-card-header h4 {
    margin: 0; font-size: 17px; font-weight: 700;
    display: inline-block; /* 클릭 영역을 위해 */
}

/* [v4.1] (원본 보기) 힌트 텍스트 스타일 */
.view-original-hint {
    font-weight: 500;
    font-size: 13px;
    color: #888;
    margin-left: 8px;
    display: inline-block; /* h4 옆에 붙도록 */
}

/* [추가] 아코디언이 열렸을 때의 스타일 */
.review-card[open] {
    /* [v4.1] 헤더와 본문 색상 대비 */
    background-color: var(--white-color);
}
.review-card[open] .review-card-header {
    /* 열렸을 때는 summary와 body 사이에 선이 없도록 함 */
    border-bottom: none; 
}

/* [수정] review-card-body의 border-top 추가 (열렸을 때 선) */
.review-card-body {
    padding: 24px;
    display: grid;
    /* [v4.1] 가독성을 위해 1단 세로 스택으로 변경 */
    grid-template-columns: 1fr;
    gap: 24px;
    border-top: 1px solid var(--border-color); /* 헤더와 구분선 */
}
/* --- [끝] 아코디언 UI 수정 --- */

.review-card-body .original-text-container { display: none; }

.user-analysis-box, .coach-feedback-box {
    background-color: var(--white-color);
    border-radius: 12px; /* [v4.0] */
    padding: 20px;
}
.user-analysis-box {
    border: 1px solid var(--success-color);
    background-color: #f6fff8;
}
.coach-feedback-box {
    border: 1px solid var(--primary-color);
    background-color: #f7f9ff;
}
.review-card h5 {
    margin: 0 0 12px 0; font-size: 16px; font-weight: 700;
    display: flex; align-items: center; gap: 8px;
}
.user-analysis-box h5 { color: var(--success-color); }
.coach-feedback-box h5 { color: var(--primary-color); }

.review-card p {
    margin: 0; font-size: 15px; line-height: 1.7;
    color: #444; word-break: keep-all;
}
.review-card p.empty-analysis {
    color: #888;
    font-style: italic;
}

.coach-feedback-box p strong {
    color: var(--primary-color);
    font-weight: 700;
    font-size: 15px;
}
.coach-feedback-box p strong {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
}

/* [v4.1] 피드백 요약 패널 (이제 .report-header 내부에 위치함) */
.feedback-details {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
    text-align: left;
    /* [v4.1] html 구조 변경으로 mb 제거 */
}
.feedback-panel {
    background-color: var(--light-bg-color);
    border-radius: 12px; /* [v4.0] */
    padding: 32px;
}
.feedback-panel h3 {
    margin: 0 0 16px 0; font-size: 20px;
    display: flex; align-items: center;
    gap: 8px; font-weight: 700;
}
#good-points-panel h3 { color: var(--success-color); }
#improvement-points-panel h3 { color: var(--warning-color); }
.feedback-panel ul { list-style-type: none; padding: 0; margin: 0; }
.feedback-panel li {
    margin-bottom: 12px; font-size: 16px; line-height: 1.7;
    padding-left: 24px; position: relative;
}
#good-points-panel li::before {
    content: '👍'; position: absolute; left: 0; top: 2px;
}
#improvement-points-panel li::before {
    content: '📈'; position: absolute; left: 0; top: 2px;
}
/* --- [END v2.1] 피드백 리포트 --- */


/* 동적 로더 스타일 */
#dynamic-loader {
    text-align: center; padding: 48px;
    flex-direction: column; gap: 24px;
    align-items: center; justify-content: center;
    border-radius: 20px; /* [v4.0] */
}
.spinner {
    border: 6px solid #f3f3f3;
    border-top: 6px solid var(--primary-color);
    border-radius: 50%; width: 50px; height: 50px;
    animation: spin 1s linear infinite;
}
#loader-text {
    font-size: 18px; font-weight: 600;
    color: var(--text-color); margin: 0;
}

footer {
    text-align: center; padding: 20px;
    font-size: 14px; color: #999;
    margin-top: 64px;
}

.hidden { display: none !important; }

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* --- [추가] 원본 텍스트 뷰어 모달 --- */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    padding: 24px;
    animation: fadeIn 0.3s ease;
}

.modal-content {
    background: var(--white-color);
    border-radius: 16px;
    padding: 32px;
    max-width: 600px;
    width: 100%;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    position: relative;
    max-height: 80vh;
    overflow-y: auto;
    box-sizing: border-box; /* 패딩 포함 크기 계산 */
}

.modal-content h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 20px;
    font-weight: 700;
}

#modal-chunk-text {
    background: var(--light-bg-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 20px;
    font-size: 16px;
    line-height: 1.7;
    word-break: keep-all;
    max-height: 50vh; /* 모달 내용이 길어질 경우 스크롤 */
    overflow-y: auto;
}

.modal-close {
    position: absolute;
    top: 16px;
    right: 16px;
    background: none;
    border: none;
    font-size: 28px;
    font-weight: 700;
    color: #888;
    cursor: pointer;
    line-height: 1;
    padding: 8px;
}
.modal-close:hover {
    color: #333;
}
/* --- [끝] 모달 --- */


/* 모바일 반응형 */
@media (max-width: 768px) {
    .container { padding: 32px 20px; } /* [v4.0] */
    header h1 { font-size: 32px; } /* [v4.0] */
    header p { font-size: 17px; }
    .main-card { padding: 24px; border-radius: 16px; } /* [v4.0] */
    .chunk-card { padding: 20px; }
    .feedback-panel { padding: 24px; }
    
    /* [v4.0] 단계별 제목 모바일 */
    .step-title {
        font-size: 28px;
    }
    /* [v4.0] 뒤로 가기 버튼 모바일 */
    .btn-back {
        top: 20px;
        left: 20px;
        width: 36px;
        height: 36px;
        font-size: 18px;
        line-height: 36px;
    }
    #course-section .step-title {
        padding-top: 20px;
    }

    #text-input { height: 150px; }
    .course-options { flex-direction: column; }
    .chunk-card { grid-template-columns: 1fr; }
    
    #feedback-score { font-size: 80px; }
    #feedback-summary { font-size: 18px; }
    
    .review-card-body { grid-template-columns: 1fr; }
    .feedback-details { grid-template-columns: 1fr; }
    
    /* [v4.1] 리포트 버튼 모바일 (기존 100% 너비)
       이제 데스크탑 기본값이 100%이므로, 
       기존 덮어쓰기(line 622-630)는 삭제되었습니다.
    */

    /* 모달 모바일 */
    .modal-content {
        padding: 24px;
    }
}